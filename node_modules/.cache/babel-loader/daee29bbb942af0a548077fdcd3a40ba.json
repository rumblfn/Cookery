{"ast":null,"code":"import _defineProperty from\"/Users/samilvaliahmetov/education/programming/local-github/cookkery/client/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _toConsumableArray from\"/Users/samilvaliahmetov/education/programming/local-github/cookkery/client/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _objectSpread from\"/Users/samilvaliahmetov/education/programming/local-github/cookkery/client/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import{ADD_NEW_RECIPE,SET_RECIPES,SET_RECIPES_ALL,CLEAR_REDUCER,STAR_RECIPE,SET_STARRED_RECIPES,setRecipeImages,SET_RECIPE_IMAGES}from'./actions';import Axios from'axios';import{nanoid}from'nanoid';var initialState={userRecipes:{},recipes:{},starred_recipes:{}};export var recipesReducer=function recipesReducer(){var state=arguments.length>0&&arguments[0]!==undefined?arguments[0]:initialState;var action=arguments.length>1?arguments[1]:undefined;switch(action.type){case STAR_RECIPE:{switch(action.payload.starred){case true:{var userRecipeCopy=_objectSpread({},state.userRecipes);var recipesCopy=_objectSpread({},state.recipes);var recipeId=action.payload.recipeId;if(recipeId in userRecipeCopy){userRecipeCopy[recipeId].rating-=1;}if(recipeId in recipesCopy){recipesCopy[recipeId].rating-=1;}return _objectSpread(_objectSpread({},state),{},{userRecipes:userRecipeCopy,recipes:recipesCopy});}case false:{var _userRecipeCopy=_objectSpread({},state.userRecipes);var _recipesCopy=_objectSpread({},state.recipes);var _recipeId=action.payload.recipeId;if(_recipeId in _userRecipeCopy){_userRecipeCopy[_recipeId].rating+=1;}if(_recipeId in _recipesCopy){_recipesCopy[_recipeId].rating+=1;}return _objectSpread(_objectSpread({},state),{},{userRecipes:_userRecipeCopy,recipes:_recipesCopy});}default:{return state;}}}case SET_RECIPE_IMAGES:{return _objectSpread(_objectSpread({},state),{},{userRecipes:_objectSpread(_objectSpread({},state.userRecipes),{},_defineProperty({},action.payload.id,_objectSpread(_objectSpread({},state.userRecipes[action.payload.id]),{},{images:_toConsumableArray(action.payload.images)})))});}case SET_RECIPES_ALL:{console.log(action.payload);var settedRecipes={};action.payload.forEach(function(item){settedRecipes[item.id]={comments:JSON.parse(item.comments),cook:JSON.parse(item.cook),description:JSON.parse(item.description),id:item.id,images:JSON.parse(item.images)||[],lstOfProducts:JSON.parse(item.lstOfProducts),products:JSON.parse(item.products),rating:item.rating,time:item.time,title:item.title,userId:item.userId};});return _objectSpread(_objectSpread({},state),{},{recipes:_objectSpread(_objectSpread({},state.recipes),settedRecipes)});}case SET_STARRED_RECIPES:{var settedUserStarredRecipes={};if(action.payload){action.payload.forEach(function(item){settedUserStarredRecipes[item.id]={comments:JSON.parse(item.comments),cook:JSON.parse(item.cook),description:JSON.parse(item.description),id:item.id,images:JSON.parse(item.images)||{},lstOfProducts:JSON.parse(item.lstOfProducts),products:JSON.parse(item.products),rating:item.rating,time:item.time,title:item.title,userId:item.userId};});return _objectSpread(_objectSpread({},state),{},{starred_recipes:_objectSpread({},settedUserStarredRecipes)});}return state;}case SET_RECIPES:{var settedUserRecipes={};action.payload.forEach(function(item){settedUserRecipes[item.id]={comments:JSON.parse(item.comments),cook:JSON.parse(item.cook),description:JSON.parse(item.description),id:item.id,images:JSON.parse(item.images)||{},lstOfProducts:JSON.parse(item.lstOfProducts),products:JSON.parse(item.products),rating:item.rating,time:item.time,title:item.title,userId:item.userId};});return _objectSpread(_objectSpread({},state),{},{userRecipes:_objectSpread(_objectSpread({},state.userRecipes),settedUserRecipes)});}case ADD_NEW_RECIPE:{var images={};var paths=[];Object.keys(action.payload.images).forEach(function(item){var image_path=\"\".concat(nanoid(8)).concat(item);paths.push(image_path);images[image_path]=action.payload.images[item];});Axios.post('/reciepes/insert',_objectSpread(_objectSpread({},action.payload),{},{images:JSON.stringify(images)})).then(function(res){if(res){setRecipeImages({id:action.payload.id,images:_toConsumableArray(res.data)});}});return _objectSpread(_objectSpread({},state),{},{userRecipes:_objectSpread(_objectSpread({},state.userRecipes),{},_defineProperty({},action.payload.id,_objectSpread(_objectSpread({},action.payload),{},{images:[].concat(paths)})))});}case CLEAR_REDUCER:{return _objectSpread(_objectSpread({},state),{},{userRecipes:{}});}default:{return state;}}};","map":{"version":3,"sources":["/Users/samilvaliahmetov/education/programming/local-github/cookkery/client/src/store/recipes/reducer.js"],"names":["ADD_NEW_RECIPE","SET_RECIPES","SET_RECIPES_ALL","CLEAR_REDUCER","STAR_RECIPE","SET_STARRED_RECIPES","setRecipeImages","SET_RECIPE_IMAGES","Axios","nanoid","initialState","userRecipes","recipes","starred_recipes","recipesReducer","state","action","type","payload","starred","userRecipeCopy","recipesCopy","recipeId","rating","id","images","console","log","settedRecipes","forEach","item","comments","JSON","parse","cook","description","lstOfProducts","products","time","title","userId","settedUserStarredRecipes","settedUserRecipes","paths","Object","keys","image_path","push","post","stringify","then","res","data"],"mappings":"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","sourcesContent":["import { ADD_NEW_RECIPE, SET_RECIPES, SET_RECIPES_ALL, CLEAR_REDUCER, STAR_RECIPE, SET_STARRED_RECIPES, setRecipeImages, SET_RECIPE_IMAGES } from './actions';\nimport Axios from 'axios';\nimport { nanoid } from 'nanoid';\n\nconst initialState = {\n    userRecipes: {},\n    recipes: {},\n    starred_recipes: {},\n}\n\nexport const recipesReducer = (state = initialState, action) => {\n    switch (action.type) {\n        case STAR_RECIPE: {\n            switch (action.payload.starred) {\n                case true: {\n                    let userRecipeCopy = {...state.userRecipes}\n                    let recipesCopy = {...state.recipes}\n                    const recipeId = action.payload.recipeId\n                    if (recipeId in userRecipeCopy) {\n                        userRecipeCopy[recipeId].rating -= 1;\n                    }\n                    if (recipeId in recipesCopy) {\n                        recipesCopy[recipeId].rating -= 1;\n                    }\n                    return {...state, userRecipes: userRecipeCopy, recipes: recipesCopy}\n                }\n                case false: {\n                    let userRecipeCopy = {...state.userRecipes}\n                    let recipesCopy = {...state.recipes}\n                    const recipeId = action.payload.recipeId\n                    if (recipeId in userRecipeCopy) {\n                        userRecipeCopy[recipeId].rating += 1;\n                    }\n                    if (recipeId in recipesCopy) {\n                        recipesCopy[recipeId].rating += 1;\n                    }\n                    return {...state, userRecipes: userRecipeCopy, recipes: recipesCopy}\n                }\n                default: {\n                    return state\n                }\n            }\n        }\n        case SET_RECIPE_IMAGES: {\n            return {\n                ...state,\n                userRecipes: {...state.userRecipes, [action.payload.id]: {...state.userRecipes[action.payload.id], images: [...action.payload.images]}}\n            }\n        }\n        case SET_RECIPES_ALL: {\n            console.log(action.payload)\n            const settedRecipes = {}\n            action.payload.forEach((item) => {\n                settedRecipes[item.id] = {\n                    comments: JSON.parse(item.comments),\n                    cook: JSON.parse(item.cook),\n                    description: JSON.parse(item.description),\n                    id: item.id,\n                    images: JSON.parse(item.images) || [],\n                    lstOfProducts: JSON.parse(item.lstOfProducts),\n                    products: JSON.parse(item.products),\n                    rating: item.rating,\n                    time: item.time,\n                    title: item.title,\n                    userId: item.userId\n                }\n            })\n            return {...state, recipes: {...state.recipes, ...settedRecipes}}\n        }\n        case SET_STARRED_RECIPES: {\n            const settedUserStarredRecipes = {}\n            if (action.payload) {\n                action.payload.forEach((item) => {\n                    settedUserStarredRecipes[item.id] = {\n                        comments: JSON.parse(item.comments),\n                        cook: JSON.parse(item.cook),\n                        description: JSON.parse(item.description),\n                        id: item.id,\n                        images: JSON.parse(item.images) || {},\n                        lstOfProducts: JSON.parse(item.lstOfProducts),\n                        products: JSON.parse(item.products),\n                        rating: item.rating,\n                        time: item.time,\n                        title: item.title,\n                        userId: item.userId\n                    }\n                })\n                return {...state, starred_recipes: {...settedUserStarredRecipes}}\n            }\n            return state\n        }\n        case SET_RECIPES: {\n            const settedUserRecipes = {}\n            action.payload.forEach((item) => {\n                settedUserRecipes[item.id] = {\n                    comments: JSON.parse(item.comments),\n                    cook: JSON.parse(item.cook),\n                    description: JSON.parse(item.description),\n                    id: item.id,\n                    images: JSON.parse(item.images) || {},\n                    lstOfProducts: JSON.parse(item.lstOfProducts),\n                    products: JSON.parse(item.products),\n                    rating: item.rating,\n                    time: item.time,\n                    title: item.title,\n                    userId: item.userId\n                }\n            })\n            return {...state, userRecipes: {...state.userRecipes, ...settedUserRecipes}}\n        }\n        case ADD_NEW_RECIPE: {\n            const images = {}\n            const paths = []\n            Object.keys(action.payload.images).forEach(item => {\n                let image_path = `${nanoid(8)}${item}`\n                paths.push(image_path)\n                images[image_path] = action.payload.images[item]\n            })\n            Axios.post('/reciepes/insert', {\n                ...action.payload, images: JSON.stringify(images)\n            }).then((res) => {\n                if (res) {\n                    setRecipeImages({id: action.payload.id, images: [...res.data]})\n                }\n            })\n            return {\n                ...state,\n                userRecipes: {...state.userRecipes, [action.payload.id]: {...action.payload, images: [...paths]}}\n            }\n        }\n        case CLEAR_REDUCER: {\n            return {...state, userRecipes: {}}\n        }\n        default: {\n            return state\n        }\n    }\n}"]},"metadata":{},"sourceType":"module"}